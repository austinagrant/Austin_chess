# White_Knight
from typing import TYPE_CHECKING, Generator
from piece import Piece
if TYPE_CHECKING:
    from move import Move

class W_N(Piece):
    
    positional_value = [
            -50,-40,-30,-30,-30,-30,-40,-50,
            -40,-20,  0,  0,  0,  0,-20,-40,
            -30,  0, 10, 15, 15, 10,  0,-30,
            -30,  5, 15, 20, 20, 15,  5,-30,
            -30,  0, 15, 20, 20, 15,  0,-30,
            -30,  5, 10, 15, 15, 10,  5,-30,
            -40,-20,  0,  5,  5,  0,-20,-40,
            -50,-40,-30,-30,-30,-30,-40,-50,]
    
    knight_moves = {0: 132096, 1: 329728, 2: 659712, 3: 1319424, 4: 2638848, 
                    5: 5277696, 6: 10489856, 7: 4202496, 8: 33816580, 9: 84410376, 
                    10: 168886289, 11: 337772578, 12: 675545156, 13: 1351090312, 
                    14: 2685403152, 15: 1075839008, 16: 8657044482, 17: 21609056261, 
                    18: 43234889994, 19: 86469779988, 20: 172939559976, 21: 345879119952, 
                    22: 687463207072, 23: 275414786112, 24: 2216203387392, 25: 5531918402816, 
                    26: 11068131838464, 27: 22136263676928, 28: 44272527353856, 29: 88545054707712, 
                    30: 175990581010432, 31: 70506185244672, 32: 567348067172352, 33: 1416171111120896, 
                    34: 2833441750646784, 35: 5666883501293568, 36: 11333767002587136, 37: 22667534005174272, 
                    38: 45053588738670592, 39: 18049583422636032, 40: 145241105196122112, 41: 362539804446949376, 
                    42: 725361088165576704, 43: 1450722176331153408, 44: 2901444352662306816, 45: 5802888705324613632, 
                    46: 11533718717099671552, 47: 4620693356194824192, 48: 288234782788157440, 49: 576469569871282176, 
                    50: 1224997833292120064, 51: 2449995666584240128, 52: 4899991333168480256, 53: 9799982666336960512, 
                    54: 1152939783987658752, 55: 2305878468463689728, 56: 1128098930098176, 57: 2257297371824128, 58: 4796069720358912, 
                    59: 9592139440717824, 60: 19184278881435648, 61: 38368557762871296, 62: 4679521487814656, 63: 9077567998918656
                    }
    
    knight_moves_ind = {0: [10, 17], 1: [11, 16, 18], 2: [8, 12, 17, 19], 3: [9, 13, 18, 20], 4: [10, 14, 19, 21], 5: [11, 15, 20, 22], 
                    6: [12, 21, 23], 7: [13, 22], 8: [2, 18, 25], 9: [3, 19, 24, 26], 10: [0, 4, 16, 20, 25, 27], 11: [1, 5, 17, 21, 26, 28], 
                    12: [2, 6, 18, 22, 27, 29], 13: [3, 7, 19, 23, 28, 30], 14: [4, 20, 29, 31], 15: [5, 21, 30], 16: [1, 10, 26, 33], 
                    17: [0, 2, 11, 27, 32, 34], 18: [1, 3, 8, 12, 24, 28, 33, 35], 19: [2, 4, 9, 13, 25, 29, 34, 36], 
                    20: [3, 5, 10, 14, 26, 30, 35, 37], 21: [4, 6, 11, 15, 27, 31, 36, 38], 22: [5, 7, 12, 28, 37, 39], 
                    23: [6, 13, 29, 38], 24: [9, 18, 34, 41], 25: [8, 10, 19, 35, 40, 42], 26: [9, 11, 16, 20, 32, 36, 41, 43], 
                    27: [10, 12, 17, 21, 33, 37, 42, 44], 28: [11, 13, 18, 22, 34, 38, 43, 45], 29: [12, 14, 19, 23, 35, 39, 44, 46], 
                    30: [13, 15, 20, 36, 45, 47], 31: [14, 21, 37, 46], 32: [17, 26, 42, 49], 33: [16, 18, 27, 43, 48, 50], 
                    34: [17, 19, 24, 28, 40, 44, 49, 51], 35: [18, 20, 25, 29, 41, 45, 50, 52], 36: [19, 21, 26, 30, 42, 46, 51, 53], 
                    37: [20, 22, 27, 31, 43, 47, 52, 54], 38: [21, 23, 28, 44, 53, 55], 39: [22, 29, 45, 54], 40: [25, 34, 50, 57], 
                    41: [24, 26, 35, 51, 56, 58], 42: [25, 27, 32, 36, 48, 52, 57, 59], 43: [26, 28, 33, 37, 49, 53, 58, 60], 
                    44: [27, 29, 34, 38, 50, 54, 59, 61], 45: [28, 30, 35, 39, 51, 55, 60, 62], 46: [29, 31, 36, 52, 61, 63], 
                    47: [30, 37, 53, 62], 48: [33, 42, 58], 49: [32, 34, 43, 59], 50: [33, 35, 40, 44, 56, 60], 
                    51: [34, 36, 41, 45, 57, 61], 52: [35, 37, 42, 46, 58, 62], 53: [36, 38, 43, 47, 59, 63], 54: [37, 39, 44, 60], 
                    55: [38, 45, 61], 56: [41, 50], 57: [40, 42, 51], 58: [41, 43, 48, 52], 59: [42, 44, 49, 53], 60: [43, 45, 50, 54], 
                    61: [44, 46, 51, 55], 62: [45, 47, 52], 63: [46, 53]}
    
    def __init__(self, board=0b01000010):
        super(W_N, self).__init__(board, True, 320)
    
    def __str__(self):
        return "â™˜"
    
    def move_rule(self, position_index: int) -> int:
        return self.knight_moves[position_index]
    
    # def generateMoves(self, team_board=0, opp_board=0) -> list['Move']:
    #     moves = []
    #     positions = self.bitboard
    #     while positions != 0:
    #         curr_pos = self.getMSB(positions)
    #         from move import Move
    #         moves.extend([Move(self, curr_pos, new_pos) for new_pos in self.knight_moves_ind[curr_pos] if (1 << new_pos) & team_board == 0])
    #         positions = positions ^ (1 << curr_pos)
    #     return moves
    
    
    
    
    def generateMoves(self, team_board=0, opp_board=0) -> Generator['Move', None, None]:
        from move import Move
        for pos in self.indices:
            for index in self.knight_moves_ind[pos]:
                if team_board & (1 << index) != 0:
                    continue
                else:
                    yield Move(self, pos, index)
    



    
    
    
    


